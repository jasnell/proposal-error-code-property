<!doctype html>
<meta charset="utf8">
<link rel="stylesheet" href="./spec.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
<script src="./spec.js"></script>
<pre class="metadata">
title: Error code property
stage: 0
contributors: James M Snell
</pre>

<emu-clause id="sec-error-objects">
  <h1>Error Objects</h1>

  <emu-clause id="sec-error-constructor">
    <h1>The Error Constructor</h1>

    <emu-clause id="sec-error-message">
      <h1>Error ( _message_ [ , _options_ ] )</h1>
      <p>This function performs the following steps when called:</p>
      <emu-alg>
        1. If NewTarget is *undefined*, let _newTarget_ be the active function object; else let _newTarget_ be NewTarget.
        1. Let _O_ be ? OrdinaryCreateFromConstructor(_newTarget_, *"%Error.prototype%"*, &laquo; [[ErrorData]] &raquo;).
        1. If _message_ is not *undefined*, then
          1. Let _msg_ be ? ToString(_message_).
          1. Perform CreateNonEnumerableDataPropertyOrThrow(_O_, *"message"*, _msg_).
        1. Perform ? InstallErrorCause(_O_, _options_).
        1. <ins>Perform ? InstallErrorCode(_O_, _options_).</ins>
        1. Return _O_.
      </emu-alg>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-nativeerror-object-structure">
    <h1>_NativeError_ Object Structure</h1>

    <emu-clause id="sec-nativeerror-constructors">
      <h1>The _NativeError_ Constructors</h1>

      <emu-clause id="sec-nativeerror">
        <h1>_NativeError_ ( _message_ [ , _options_ ] )</h1>
        <p>When a _NativeError_ function is called with argument _message_ and optional argument _options_, the following steps are taken:</p>
        <emu-alg>
          1. If NewTarget is *undefined*, let _newTarget_ be the active function object; else let _newTarget_ be NewTarget.
          1. Let _O_ be ? OrdinaryCreateFromConstructor(_newTarget_, <code>"%<var>NativeError</var>.prototype%"</code>, &laquo; [[ErrorData]] &raquo;).
          1. If _message_ is not *undefined*, then
            1. Let _msg_ be ? ToString(_message_).
            1. Perform CreateNonEnumerableDataPropertyOrThrow(_O_, *"message"*, _msg_).
          1. Perform ? InstallErrorCause(_O_, _options_).
          1. <ins>Perform ? InstallErrorCode(_O_, _options_).</ins>
          1. Return _O_.
        </emu-alg>
      </emu-clause>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-aggregate-error-objects">
    <h1>AggregateError Objects</h1>

    <emu-clause id="sec-aggregate-error-constructor">
      <h1>The AggregateError Constructor</h1>

      <emu-clause id="sec-aggregate-error">
        <h1>AggregateError ( _errors_, _message_ [ , _options_ ] )</h1>
        <p>This function performs the following steps when called:</p>
        <emu-alg>
          1. If NewTarget is *undefined*, let _newTarget_ be the active function object; else let _newTarget_ be NewTarget.
          1. Let _O_ be ? OrdinaryCreateFromConstructor(_newTarget_, *"%AggregateError.prototype%"*, &laquo; [[ErrorData]] &raquo;).
          1. If _message_ is not *undefined*, then
            1. Let _msg_ be ? ToString(_message_).
            1. Perform CreateNonEnumerableDataPropertyOrThrow(_O_, *"message"*, _msg_).
          1. Perform ? InstallErrorCause(_O_, _options_).
          1. <ins>Perform ? InstallErrorCode(_O_, _options_).</ins>
          1. Let _errorsList_ be ? IteratorToList(? GetIterator(_errors_, ~sync~)).
          1. Perform ! DefinePropertyOrThrow(_O_, *"errors"*, PropertyDescriptor { [[Configurable]]: *true*, [[Enumerable]]: *false*, [[Writable]]: *true*, [[Value]]: CreateArrayFromList(_errorsList_) }).
          1. Return _O_.
        </emu-alg>
      </emu-clause>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-suppressed-error-objects">
    <h1>SuppressedError Objects</h1>

    <emu-clause id="sec-suppressed-error-constructor">
      <h1>The SuppressedError Constructor</h1>

      <emu-clause id="sec-suppressed-error">
        <h1>SuppressedError ( _error_, _suppressed_, _message_ [ , _options_ ] )</h1>
        <p>This function performs the following steps when called:</p>
        <emu-alg>
          1. If NewTarget is *undefined*, let _newTarget_ be the active function object; else let _newTarget_ be NewTarget.
          1. Let _O_ be ? OrdinaryCreateFromConstructor(_newTarget_, *"%SuppressedError.prototype%"*, &laquo; [[ErrorData]] &raquo;).
          1. If _message_ is not *undefined*, then
            1. Let _messageString_ be ? ToString(_message_).
            1. Perform CreateNonEnumerableDataPropertyOrThrow(_O_, *"message"*, _messageString_).
          1. Perform ? InstallErrorCause(_O_, _options_).
          1. <ins>Perform ? InstallErrorCode(_O_, _options_).</ins>
          1. Perform CreateNonEnumerableDataPropertyOrThrow(_O_, *"error"*, _error_).
          1. Perform CreateNonEnumerableDataPropertyOrThrow(_O_, *"suppressed"*, _suppressed_).
          1. Return _O_.
        </emu-alg>
      </emu-clause>
    </emu-clause>
  </emu-clause>

  <emu-clause id="sec-errorobjects-abstracts">
    <h1>Abstract Operations for Error Objects</h1>

    <emu-clause id="sec-installerrorcode" type="abstract operation">
      <h1>
        <ins>InstallErrorCode (
          _O_: an Object,
          _options_: an ECMAScript language value,
        ): either a normal completion containing ~unused~ or a throw completion</ins>
      </h1>
      <dl class="header">
        <dt>description</dt>
        <dd><ins>It is used to create a *"code"* property on _O_ when a *"code"* property is present on _options_.</ins></dd>
      </dl>
      <emu-alg>
        1. <ins>If _options_ is an Object and ? HasProperty(_options_, *"code"*) is *true*, then</ins>
          1. <ins>Let _code_ be ? Get(_options_, *"code"*).</ins>
          1. <ins>Perform CreateNonEnumerableDataPropertyOrThrow(_O_, *"code"*, _code_).</ins>
        1. <ins>Return ~unused~.</ins>
      </emu-alg>
    </emu-clause>
  </emu-clause>
</emu-clause>
